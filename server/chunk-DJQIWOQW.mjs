import './polyfills.server.mjs';
import{a as T,c as N,e as O,m as V}from"./chunk-5EY626D2.mjs";import{a as E}from"./chunk-BF5KGVNB.mjs";import{$ as h,L as c,M as d,Na as b,Oa as w,R as S,S as g,Va as M,W as o,X as r,aa as _,ba as a,fa as s,hb as I,ia as f,ja as v,jb as P,ka as C,m as x,ma as y,r as l,s as m}from"./chunk-Q6QYHI2G.mjs";import{h as u}from"./chunk-5XUXGTUW.mjs";function k(n,L){if(n&1){let t=h();o(0,"div")(1,"h3"),s(2,"Enter your phone number"),r(),o(3,"input",1),C("ngModelChange",function(i){l(t);let p=a();return v(p.phoneNumber,i)||(p.phoneNumber=i),m(i)}),r(),o(4,"button",2),_("click",function(){l(t);let i=a();return m(i.sendOtp())}),s(5,"Send OTP"),r()()}if(n&2){let t=a();c(3),f("ngModel",t.phoneNumber)}}function W(n,L){if(n&1){let t=h();o(0,"div")(1,"h3"),s(2,"Enter the OTP"),r(),o(3,"input",3),C("ngModelChange",function(i){l(t);let p=a();return v(p.otp,i)||(p.otp=i),m(i)}),r(),o(4,"button",2),_("click",function(){l(t);let i=a();return m(i.verifyOtp())}),s(5,"Verify OTP"),r()()}if(n&2){let t=a();c(3),f("ngModel",t.otp)}}var z=(()=>{class n{constructor(t,e,i){this.http=t,this.router=e,this.apiService=i,this.phoneNumber="",this.otp="",this.otpSent=!1}sendOtp(){return u(this,null,function*(){let t={phone_number:this.phoneNumber};yield this.apiService.getDataWithParams("/home/send-otp",t).subscribe(e=>{this.otpSent=!0},e=>{alert("Error sending OTP")})})}verifyOtp(){return u(this,null,function*(){let t={phone_number:this.phoneNumber,otp:this.otp};yield this.apiService.getDataWithParams("/home/verify-otp",t).subscribe(e=>{e.statusCode===401&&e.message==="Invalid OTP"?alert("Invalid OTP"):(localStorage.setItem("auth_token",e.token),localStorage.setItem("phoneNumber",this.phoneNumber),localStorage.setItem("loggedInUserId",e.userDetails.result[0].user_id),this.router.navigate(["/home"]))},e=>{alert("Invalid OTP")})})}static{this.\u0275fac=function(e){return new(e||n)(d(M),d(I),d(E))}}static{this.\u0275cmp=x({type:n,selectors:[["app-login"]],standalone:!0,features:[y],decls:4,vars:2,consts:[[4,"ngIf"],["type","text","placeholder","Phone Number",3,"ngModelChange","ngModel"],[3,"click"],["type","text","placeholder","Enter OTP",3,"ngModelChange","ngModel"]],template:function(e,i){e&1&&(o(0,"p"),s(1,"login works!"),r(),S(2,k,6,1,"div",0)(3,W,6,1,"div",0)),e&2&&(c(2),g("ngIf",!i.otpSent),c(),g("ngIf",i.otpSent))},dependencies:[w,b,P,V,T,N,O]})}}return n})();export{z as LoginComponent};
