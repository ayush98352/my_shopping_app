import './polyfills.server.mjs';
import{c as W,e as A,i as q,j as H,k as $,m as X}from"./chunk-5EY626D2.mjs";import{a as J}from"./chunk-FGAN7Y3N.mjs";import{a as G}from"./chunk-4LTLXOTK.mjs";import{$ as w,J as b,Ka as V,L as c,M as _,Ma as j,Na as R,Oa as D,R as P,S as h,Ua as E,Va as U,W as n,X as i,Y as x,aa as p,ba as d,fa as r,g as I,ga as f,ha as s,hb as L,ia as M,j as T,ja as O,jb as N,ka as k,m as B,ma as z,na as F,r as m,s as u,t as y,u as S}from"./chunk-Q6QYHI2G.mjs";import{h as g}from"./chunk-5XUXGTUW.mjs";var K=(()=>{class l{constructor(e){this.http=e,this.apiLink="http://localhost:7399",this.csrfToken=null}fetchCsrfToken(){let e=this.apiLink+"/auth/csrf-token";return this.http.get(e).subscribe(o=>{this.csrfToken=o.csrfToken})}createOrder(e){console.log("service_amount",e),this.csrfToken||this.fetchCsrfToken();let o=new E({"X-CSRF-Token":this.csrfToken||""}),t=this.apiLink+"/payment/create-order";return this.http.post(t,{amount:e},{headers:o})}verifyPayment(e){console.log("service_data",e);let o=this.apiLink+"/payment/verify-payment";this.csrfToken||this.fetchCsrfToken();let t=new E({"X-CSRF-Token":this.csrfToken||""});return this.http.post(o,e,{headers:t})}static{this.\u0275fac=function(o){return new(o||l)(T(U))}}static{this.\u0275prov=I({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var Z=()=>[1,2,3,4,5];function ee(l,v){if(l&1&&(n(0,"option",42),r(1),i()),l&2){let e=v.$implicit;h("value",e),c(),f(e)}}function te(l,v){if(l&1){let e=w();n(0,"div",24)(1,"img",25),p("click",function(){let t=m(e).$implicit,a=d();return u(a.gotoShowProductPage(t))}),i(),n(2,"div",26)(3,"div",27)(4,"div",28),p("click",function(){let t=m(e).$implicit,a=d();return u(a.gotoShowProductPage(t))}),n(5,"h2"),r(6),i(),n(7,"p"),r(8),i()(),n(9,"img",29),p("click",function(t){let a=m(e).$implicit,C=d();return u(C.showRemoveConfirmation(a,t))}),i()(),n(10,"div",30)(11,"select",31),k("ngModelChange",function(t){let a=m(e).$implicit;return O(a.size,t)||(a.size=t),u(t)}),p("change",function(){let t=m(e).$implicit,a=d();return u(a.updateCartInfo(t))}),n(12,"option",32),r(13,"S"),i(),n(14,"option",33),r(15,"M"),i(),n(16,"option",34),r(17,"L"),i(),n(18,"option",35),r(19,"XL"),i()(),n(20,"select",31),k("ngModelChange",function(t){let a=m(e).$implicit;return O(a.quantity,t)||(a.quantity=t),u(t)}),p("change",function(){let t=m(e).$implicit,a=d();return u(a.updateCartInfo(t))}),P(21,ee,2,2,"option",36),i()(),n(22,"div",37)(23,"span",38),r(24),i(),n(25,"span",39),r(26),i(),n(27,"span",40),r(28),i()(),n(29,"p",41),r(30),i()()()}if(l&2){let e=v.$implicit,o=d();c(),h("src","assets/img/products/"+(e==null?null:e.main_image)+".jpg",b)("alt",e==null?null:e.main_image),c(5),f(e==null?null:e.brand_name),c(2),f(e==null?null:e.product_short_name),c(3),M("ngModel",e.size),c(9),M("ngModel",e.quantity),c(),h("ngForOf",F(11,Z)),c(3),s("\u20B9",(e==null?null:e.selling_price)*(e==null?null:e.quantity),""),c(2),s("\u20B9",(e==null?null:e.mrp)*(e==null?null:e.quantity),""),c(2),s("(",e==null?null:e.discount_percent,"% OFF)"),c(2),s("Delivery between ",o.deliveryDate,"")}}function ne(l,v){if(l&1&&(n(0,"p",43),r(1),i()),l&2){let e=d();c(),f(e.paymentError)}}function ie(l,v){if(l&1){let e=w();n(0,"div",44)(1,"div",45)(2,"div",46)(3,"div",47),x(4,"img",48),n(5,"h3"),r(6,"Remove Product"),i()(),n(7,"img",49),p("click",function(){m(e);let t=d();return u(t.closePopups())}),i()(),n(8,"p"),r(9,"Are you sure you want to remove this product from your Bag?"),i(),n(10,"div",24),x(11,"img",50),n(12,"div",26)(13,"h2"),r(14),i(),n(15,"p"),r(16),i(),n(17,"span",51),r(18),i(),n(19,"span",52)(20,"span",53),r(21),i(),r(22," ("),n(23,"span",54),r(24),i(),r(25,") "),i()()(),n(26,"div",55)(27,"button",56),p("click",function(t){m(e);let a=d();return u(a.addToWishlist(a.selectedProduct,t))}),r(28,"Move to Wishlist"),i(),n(29,"button",57),p("click",function(){m(e);let t=d();return u(t.confirmRemoveFromWishlist())}),r(30,"Remove"),i()()()()}if(l&2){let e=d();c(11),h("src","assets/img/products/"+(e.selectedProduct==null?null:e.selectedProduct.main_image)+".jpg",b)("alt",e.selectedProduct==null?null:e.selectedProduct.main_image),c(3),f(e.selectedProduct==null?null:e.selectedProduct.brand_name),c(2),f(e.selectedProduct==null?null:e.selectedProduct.product_short_name),c(2),s("\u20B9",e.selectedProduct==null?null:e.selectedProduct.selling_price," \xA0"),c(3),s("\u20B9",e.selectedProduct==null?null:e.selectedProduct.mrp,""),c(3),s("",e.selectedProduct==null?null:e.selectedProduct.discount_percent,"% OFF")}}var ge=(()=>{class l{constructor(e,o,t,a,C){this.apiService=e,this.router=o,this.dataShareService=t,this.location=a,this.paymentService=C,this.deliveryAddress="Ayush Kumar, Bhartiya City, Nikoo homes 2, Bengaluru",this.deliveryDate="13 Oct - 18 Oct",this.loggedInUserId=localStorage.getItem("loggedInUserId"),this.products=[],this.totalPrice=0,this.totalDiscount=0,this.totalMRP=0,this.totalProductsInBag=0,this.showRemovePopup=!1,this.orderAmount=0,this.paymentError=null}ngOnInit(){return g(this,null,function*(){yield this.getCartDetails()})}getCartDetails(){return g(this,null,function*(){let e={user_id:this.loggedInUserId};yield this.apiService.getDataWithParams("/home/getCartDetails",e).subscribe(o=>{this.products=JSON.parse(JSON.stringify(o.result)),this.calcSummaryPrice(),this.totalProductsInBag=this.products.length},o=>{console.error("Error fetching data:",o)})})}updateCartInfo(e){return g(this,null,function*(){let o={product:JSON.stringify(e)};yield this.apiService.getDataWithParams("/home/updateCartInfo",o).subscribe(t=>{t.code==200&&t.message=="sucess"&&t.result=="Cart Updated Succesfully"?(console.log("data updated"),this.calcSummaryPrice()):alert("Unable to update cart info")},t=>{alert("Unable to update cart info"),console.error("Error fetching data:",t)})})}removeFromCart(e){return g(this,null,function*(){let o={cart_id:e.cart_id};yield this.apiService.getDataWithParams("/home/removeFromCart",o).subscribe(t=>{t.code==200&&t.message=="sucess"&&t.result=="Removed Succesfully"?(this.products=this.products.filter(a=>a.cart_id!==e.cart_id),this.calcSummaryPrice()):alert("Unable to remove from cart")},t=>{alert("Unable to remove from cart"),console.error("Error fetching data:",t)})})}calcSummaryPrice(){return g(this,null,function*(){this.totalPrice=0,this.totalDiscount=0,this.totalMRP=0,this.products.forEach(e=>{this.totalPrice+=Number(e.selling_price*e.quantity),this.totalMRP+=Number(e.mrp*e.quantity)}),this.totalDiscount=this.totalMRP-this.totalPrice})}showRemoveConfirmation(e,o){return g(this,null,function*(){o.stopPropagation(),o.preventDefault(),this.selectedProduct=e,this.showRemovePopup=!0})}confirmRemoveFromWishlist(){return g(this,null,function*(){this.selectedProduct&&(yield this.removeFromCart(this.selectedProduct),this.closePopups())})}addToWishlist(e,o){return g(this,null,function*(){o.stopPropagation(),o.preventDefault();let t={user_id:this.loggedInUserId,product_id:e.product_id};yield this.apiService.getDataWithParams("/home/addToWishlist",t).subscribe(a=>{a.code==200&&a.message=="sucess"?(this.removeFromCart(e),console.log("added to wishlist")):alert("Unable to add to wishlist")}),this.closePopups()})}handlePaymentSuccess(e){console.log("Payment Success:",e),alert("Payment successful. Order has been placed.")}placeOrder(){this.orderAmount=1,this.paymentService.createOrder(this.orderAmount).subscribe(e=>{let o=e;console.log("Order details:",o),this.processPayment(o)},e=>{console.error("Error creating order:",e),this.paymentError="Failed to create payment order"})}processPayment(e){let o={key:"rzp_test_O6NVokGEP2mmkE",amount:e.amount,currency:"INR",name:"My-Store",description:"Test Transaction",order_id:e.id,handler:a=>{console.log("respne_before",a),this.verifyPayment(a)},prefill:{name:"Customer Name",email:"customer@example.com",contact:"8529736991"},method:["card","upi","wallet"],theme:{color:"#3399cc"}},t=new window.Razorpay(o);t.open(),t.on("payment.failed",a=>{console.error("Payment Failed:",a),this.paymentError="Payment failed. Please try again."})}verifyPayment(e){this.paymentService.verifyPayment(e).subscribe(o=>{console.log("response_verification",o),o.status=="Payment verified successfully!"?alert("Payment successful!"):alert("Payment verification failed.")},o=>{console.error("Error verifying payment:",o),alert("Payment verification failed. Please contact support.")})}closePopups(){this.showRemovePopup=!1}goToWishlistPage(){return this.router.navigate(["/wishlist",this.loggedInUserId])}goBackToPreviousPage(){this.location.back()}gotoShowProductPage(e){return this.dataShareService.setProductDetails(e),this.router.navigate(["/product",e.product_id])}static{this.\u0275fac=function(o){return new(o||l)(_(G),_(L),_(J),_(V),_(K))}}static{this.\u0275cmp=B({type:l,selectors:[["app-shopping-bag"]],standalone:!0,features:[z],decls:64,vars:9,consts:[[1,"shopping-bag"],[1,"header"],["width","32","height","31","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"header-icon",3,"click"],["d","M15 18L9 12L15 6","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["width","32","height","31","viewBox","0 0 24 24","fill","none",1,"header-icon",3,"click"],["d","M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z","stroke","#242424","stroke-width","2"],[1,"delivery-info"],[1,"change-button"],[1,"product-list"],["class","product-item",4,"ngFor","ngForOf"],[1,"frame","coupon-section"],[1,"coupon-header"],["src","/assets/svg/coupon-icon.svg",2,"margin-bottom","-3px"],[1,"coupon-card"],[2,"display","flex","justify-content","space-between"],[1,"coupon-code"],[1,"apply-coupon"],[1,"frame","price-details"],[1,"price-row"],[1,"price-row",2,"padding-top","10px"],[1,"frame"],[1,"place-order",3,"click"],["class","error",4,"ngIf"],["class","popup-overlay",4,"ngIf"],[1,"product-item"],[1,"product-image",3,"click","src","alt"],[1,"product-details"],[2,"justify-content","space-between","display","flex"],[3,"click"],["src","assets/svg/delete-icon.svg","alt","delete","width","20","height","20",1,"remove-button",3,"click"],[1,"product-options"],[3,"ngModelChange","change","ngModel"],["value","S"],["value","M"],["value","L"],["value","XL"],[3,"value",4,"ngFor","ngForOf"],[1,"product-price"],[1,"current-price"],[1,"original-price"],[1,"discount"],[1,"delivery-date"],[3,"value"],[1,"error"],[1,"popup-overlay"],[1,"popup-content"],[2,"display","flex","align-items","center","justify-content","space-between"],[2,"display","flex","gap","7px"],["src","assets/svg/delete-icon.svg","alt","delete","width","20","height","20",1,"remove-button",2,"position","static"],["src","/assets/svg/cross.svg","alt","cancel","width","15","height","15",3,"click"],[1,"product-image",3,"src","alt"],[1,"selling-price"],[1,"mrp-discount"],[1,"mrp"],[1,"discount-percent"],[1,"popup-buttons"],[1,"cancel",3,"click"],[1,"confirm",3,"click"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1),y(),n(2,"svg",2),p("click",function(){return t.goBackToPreviousPage()}),x(3,"path",3),i(),S(),n(4,"h2"),r(5,"Shopping Bag"),i(),y(),n(6,"svg",4),p("click",function(){return t.goToWishlistPage()}),x(7,"path",5),i()(),S(),n(8,"div",6)(9,"div")(10,"strong"),r(11,"Deliver to:"),i(),r(12),i(),n(13,"button",7),r(14,"Change"),i()(),n(15,"div",8),P(16,te,31,12,"div",9),i(),n(17,"div",10)(18,"div",11)(19,"h2"),r(20,"Coupon for you "),x(21,"img",12),i(),n(22,"p"),r(23,"All Coupons"),i()(),n(24,"div",13)(25,"h3"),r(26,"Extra \u20B9200 OFF"),i(),n(27,"p"),r(28,"10% off on minimum purchase of \u20B91040.00"),i(),n(29,"div",14)(30,"span",15),r(31,"COUPON50"),i(),n(32,"button",16),r(33,"APPLY COUPON"),i()()()(),n(34,"div",17)(35,"h3"),r(36),i(),n(37,"div",18)(38,"span"),r(39,"Total MRP"),i(),n(40,"span"),r(41),i()(),n(42,"div",18)(43,"span"),r(44,"Discount on MRP"),i(),n(45,"span"),r(46),i()(),n(47,"div",18)(48,"span"),r(49,"Shipping Fee"),i(),n(50,"span"),r(51,"\u20B90"),i()(),n(52,"div",19)(53,"strong"),r(54,"TOTAL AMOUNT"),i(),n(55,"strong"),r(56),i()()(),n(57,"div",20)(58,"p"),r(59),i(),n(60,"button",21),p("click",function(){return t.placeOrder()}),r(61,"Place Order"),i()(),P(62,ne,2,1,"p",22)(63,ie,31,7,"div",23),i()),o&2&&(c(12),s(" ",t.deliveryAddress," "),c(4),h("ngForOf",t.products),c(20),s("Price Details (",t.totalProductsInBag," Items)"),c(5),s("\u20B9",t.totalMRP,""),c(5),s("-\u20B9",t.totalDiscount,""),c(10),s("\u20B9",t.totalPrice,""),c(3),s("",t.totalProductsInBag," Items Selected"),c(3),h("ngIf",t.paymentError),c(),h("ngIf",t.showRemovePopup))},dependencies:[D,j,R,N,X,H,$,q,W,A],styles:[".shopping-bag[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}h1[_ngcontent-%COMP%]{font-size:24px;margin:0}.back-button[_ngcontent-%COMP%], .wishlist-button[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer}.delivery-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.change-button[_ngcontent-%COMP%]{background:none;border:none;color:red;cursor:pointer}.product-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.product-item[_ngcontent-%COMP%]{display:flex;gap:20px;position:relative;background-color:#f9f9f9;padding:15px;border-radius:10px}.product-image[_ngcontent-%COMP%]{width:100px;height:100px;object-fit:cover;border-radius:5px}.product-details[_ngcontent-%COMP%]{flex-grow:1}.product-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin:0 0 5px}.product-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:0 0 10px}.product-options[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:10px}.product-options[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:5px}.product-price[_ngcontent-%COMP%]{margin-bottom:5px}.current-price[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.original-price[_ngcontent-%COMP%]{text-decoration:line-through;color:#888;margin-left:5px}.discount[_ngcontent-%COMP%]{color:red;margin-left:5px}.delivery-date[_ngcontent-%COMP%]{font-size:12px;color:#888}.remove-button[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:none;border:none;font-size:20px;cursor:pointer}.header[_ngcontent-%COMP%]{background-color:#fff;padding:15px 0;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 4px #0000001a;margin-bottom:20px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.header-icon[_ngcontent-%COMP%]{width:32px;height:25px;margin-left:5px;margin-right:5px;cursor:pointer}.frame[_ngcontent-%COMP%]{padding:15px 13px;width:100%;box-sizing:border-box}.coupon-section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.coupon-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-direction:row;padding:0}.coupon-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:500;font-size:18px;line-height:10px}.coupon-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:18px;line-height:10px;color:#f52727}.coupon-card[_ngcontent-%COMP%]{border:1px solid #4CAF50;border-radius:8px;padding:10px}.coupon-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-style:normal;font-weight:550;font-size:16px;line-height:0px}.coupon-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Poppins;font-style:normal;font-weight:400;font-size:12px;line-height:18px}.coupon-code[_ngcontent-%COMP%]{color:#4caf50;border:1px dashed #09C777;padding:5px}.apply-coupon[_ngcontent-%COMP%]{background-color:#fff;color:red;border:1px solid #FF0000;padding:5px 10px;cursor:pointer}.price-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.price-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-style:normal;font-size:16px;line-height:0px}.price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:400;line-height:18px;gap:10px}.place-order[_ngcontent-%COMP%]{background-color:#000;color:#fff;border:none;padding:15px;width:100%;font-size:18px;cursor:pointer}.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;text-align:left;max-width:80%;width:300px}.popup-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding:0;margin:2px;font-size:18px;line-height:18px;font-weight:500}.popup-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0;margin:2px;font-size:12px;line-height:12px;font-weight:500}.popup-buttons[_ngcontent-%COMP%]{margin-top:20px;display:flex;gap:10px;align-items:center;justify-content:center}.popup-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:30px;display:flex;justify-content:center;align-items:center;border-radius:8px;font-size:12px;font-weight:700;padding:10px 20px;cursor:pointer}.popup-buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{background-color:#fff}.popup-buttons[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]{background-color:#242424;color:#fff}.size-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:15px}.size-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;background-color:#f0f0f0;border:1px solid #ddd;cursor:pointer}.size-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff}.selling-price[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#000}.mrp-discount[_ngcontent-%COMP%]{align-items:center;margin-top:-3px}.mrp[_ngcontent-%COMP%]{font-size:12px;color:#aaa;text-decoration:line-through;margin-right:5px;font-weight:400}.discount-percent[_ngcontent-%COMP%]{font-size:12px;color:#ed4a4a;font-weight:400}"]})}}return l})();export{ge as ShoppingBagComponent};
